import{defineComponent as e,ref as t,computed as a,watch as r,mergeProps as s,unref as l,useSSRContext as d}from"vue";import{ssrRenderAttrs as i,ssrRenderAttr as o,ssrInterpolate as n,ssrIncludeBooleanAttr as p,ssrRenderList as u}from"vue/server-renderer";import{b as c}from"./server.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"unhead/plugins";import"vue-router";const v=e({__name:"transactions",__ssrInlineRender:!0,setup(e){const{selectedPerson:d}=c(),v=t([]),m=t(!1),x=t(null),g=t(""),y=t(""),b=t(""),f=t(1),h=a(()=>{let e=v.value;if("Ambos"!==d.value&&(e=e.filter(e=>e.person===d.value)),g.value&&(e=e.filter(e=>e.description.toLowerCase().includes(g.value.toLowerCase()))),y.value){const t=new Date(y.value);e=e.filter(e=>new Date(e.date)>=t)}if(b.value){const t=new Date(b.value);e=e.filter(e=>new Date(e.date)<=t)}return e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}),w=a(()=>h.value.reduce((e,t)=>e+t.amount,0)),$=a(()=>Math.ceil(h.value.length/50)),D=a(()=>50*(f.value-1)),k=a(()=>D.value+50),T=a(()=>h.value.slice(D.value,k.value)),j=a(()=>y.value&&b.value?`${formatDate(y.value)} - ${formatDate(b.value)}`:y.value?`Desde ${formatDate(y.value)}`:b.value?`Até ${formatDate(b.value)}`:""),formatDate=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pt-BR")}catch{return e}},formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);return r([g,y,b,d],()=>{f.value=1}),(e,t,a,r)=>{t(`<div${i(s({class:"min-h-screen bg-gray-50"},r))}><div class="bg-white shadow"><div class="px-8 py-6"><h1 class="text-3xl font-bold text-gray-800">Todas as Transações</h1><p class="text-gray-600 mt-1">Visualize e filtre todas as suas transações</p></div></div><div class="px-8 py-6"><div class="bg-white rounded-lg shadow p-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-2"> Buscar por descrição </label><input${o("value",g.value)} type="text" placeholder="Buscar..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-2"> Data inicial </label><input${o("value",y.value)} type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-2"> Data final </label><input${o("value",b.value)} type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></div></div><div class="mt-4 flex items-center justify-between"><div class="flex items-center gap-2 text-sm text-gray-600"><span class="font-medium">Filtros ativos:</span><span class="px-3 py-1 bg-primary-100 text-primary-800 rounded-full">${n(l(d))}</span>`),y.value||b.value?t(`<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full">${n(j.value)}</span>`):t("\x3c!----\x3e"),t(`</div><div class="flex gap-2"><button class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"> Limpar Filtros </button><button${p(m.value)?" disabled":""} class="px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400">${n(m.value?"Carregando...":"Atualizar")}</button></div></div></div></div>`),m.value?t('<div class="px-8 py-12 text-center"><div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"></div><p class="mt-4 text-gray-600">Carregando transações...</p></div>'):x.value?t(`<div class="px-8 pb-8"><div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center"><p class="text-red-800 font-medium">Erro ao carregar dados</p><p class="text-red-600 text-sm mt-2">${n(x.value)}</p></div></div>`):(t(`<div class="px-8 pb-8"><div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"><div class="bg-white rounded-lg shadow p-6"><p class="text-gray-600 text-sm font-medium">Transações Filtradas</p><p class="text-3xl font-bold text-gray-900 mt-2">${n(h.value.length)}</p></div><div class="bg-white rounded-lg shadow p-6"><p class="text-gray-600 text-sm font-medium">Valor Total</p><p class="text-3xl font-bold text-primary-600 mt-2">${n(formatCurrency(w.value))}</p></div><div class="bg-white rounded-lg shadow p-6"><p class="text-gray-600 text-sm font-medium">Valor Médio</p><p class="text-3xl font-bold text-gray-900 mt-2">${n(formatCurrency(h.value.length>0?w.value/h.value.length:0))}</p></div></div><div class="bg-white rounded-lg shadow overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Data </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Origem </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Destino </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Descrição </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Valor </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),u(T.value,e=>{t(`<tr class="hover:bg-gray-50 transition-colors"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${n(formatDate(e.date))}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${n(e.origin)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${n(e.destination)}</td><td class="px-6 py-4 text-sm text-gray-900 max-w-md truncate">${n(e.description)}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600">${n(formatCurrency(e.amount))}</td></tr>`)}),t("\x3c!--]--\x3e</tbody></table></div>"),0===h.value.length?t('<div class="text-center py-12"><p class="text-gray-500">Nenhuma transação encontrada com os filtros aplicados</p></div>'):t("\x3c!----\x3e"),h.value.length>50?t(`<div class="bg-gray-50 px-6 py-4 flex items-center justify-between border-t"><div class="text-sm text-gray-700"> Mostrando <span class="font-medium">${n(D.value+1)}</span> a <span class="font-medium">${n(Math.min(k.value,h.value.length))}</span> de <span class="font-medium">${n(h.value.length)}</span> resultados </div><div class="flex gap-2"><button${p(1===f.value)?" disabled":""} class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Anterior </button><button${p(f.value===$.value)?" disabled":""} class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Próxima </button></div></div>`):t("\x3c!----\x3e"),t("</div></div>")),t("</div>")}}}),m=v.setup;v.setup=(e,t)=>{const a=d();return(a.modules||(a.modules=new Set)).add("pages/transactions.vue"),m?m(e,t):void 0};export{v as default};
