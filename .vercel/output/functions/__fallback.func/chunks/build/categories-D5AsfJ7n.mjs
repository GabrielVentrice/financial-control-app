import{defineComponent as e,ref as t,computed as a,watch as s,mergeProps as r,unref as i,useSSRContext as n}from"vue";import{ssrRenderAttrs as l,ssrRenderAttr as o,ssrInterpolate as d,ssrIncludeBooleanAttr as c,ssrRenderList as u,ssrRenderClass as p,ssrRenderStyle as m}from"vue/server-renderer";import{b as x}from"./server.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"unhead/plugins";import"vue-router";const g=e({__name:"categories",__ssrInlineRender:!0,setup(e){const{selectedPerson:n}=x();t([]);const g=t([]),v=t(!1),y=t(null),h=t(null),f=t((()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`})()),b=["Sem Categoria","Credit Account Juliana","Credit Account Gabriel","Bank Account Juliana","Bank Account Gabriel","Credit Card Juliana","Credit Card Gabriel","Adjustment"],w=["Rent","Subscriptions/Softwares","Insurance","Utilities","Business & Taxes","Medical"],$=["Installments/Financing","Financing","Utilities","Business & Taxes","Investments","Medical","Rent","Subscriptions/Softwares","Insurance"],shouldExcludeCategory=e=>{const t=e.toLowerCase();return b.some(e=>e.toLowerCase()===t)},isCustoFixoCategory=e=>{const t=e.toLowerCase();return w.some(e=>t.includes(e.toLowerCase()))},isGastoComprometidoCategory=e=>{const t=e.toLowerCase();return $.some(e=>t.includes(e.toLowerCase()))};a(()=>{const[e,t]=f.value.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})});const C=a(()=>{let e=g.value;"Ambos"!==n.value&&(e=e.filter(e=>e.person===n.value));const[t,a]=f.value.split("-");return e=e.filter(e=>{const s=new Date(e.date);return s.getFullYear()===parseInt(t)&&s.getMonth()===parseInt(a)-1}),e}),S=a(()=>{const e=new Map;C.value.forEach(t=>{const a=t.destination||"Sem Categoria",s=e.get(a)||{count:0,total:0};e.set(a,{count:s.count+1,total:s.total+t.amount})});const t=T.value,a=[];return e.forEach((e,s)=>{shouldExcludeCategory(s)||a.push({name:s,count:e.count,total:e.total,percentage:t>0?e.total/t*100:0,average:e.total/e.count})}),a.sort((e,t)=>t.total-e.total)}),k=a(()=>C.value.filter(e=>{const t=e.destination||"Sem Categoria";return!shouldExcludeCategory(t)}));a(()=>k.value.length);const T=a(()=>k.value.reduce((e,t)=>e+t.amount,0)),I=a(()=>k.value.filter(e=>{const t=e.destination||"Sem Categoria";return isCustoFixoCategory(t)}).reduce((e,t)=>e+t.amount,0)),E=a(()=>{const e=new Set;return k.value.forEach(t=>{const a=t.destination||"Sem Categoria";isCustoFixoCategory(a)&&e.add(a)}),e.size}),D=a(()=>k.value.filter(e=>{const t=e.destination||"Sem Categoria";return isGastoComprometidoCategory(t)}).reduce((e,t)=>e+t.amount,0)),A=a(()=>{const e=new Set;return k.value.forEach(t=>{const a=t.destination||"Sem Categoria";isGastoComprometidoCategory(a)&&e.add(a)}),e.size}),G=a(()=>k.value.filter(e=>{const t=e.destination||"Sem Categoria";return!isCustoFixoCategory(t)&&!isGastoComprometidoCategory(t)}).reduce((e,t)=>e+t.amount,0)),formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),getCategoryTransactions=e=>k.value.filter(t=>(t.destination||"Sem Categoria")===e).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());return s(n,()=>{}),(e,t,a,s)=>{t(`<div${l(r({class:"min-h-screen bg-gray-50"},s))}><div class="bg-white shadow"><div class="px-8 py-6"><h1 class="text-3xl font-bold text-gray-800">Gastos por Categoria</h1><p class="text-gray-600 mt-1">An√°lise de despesas organizadas por categoria</p></div></div><div class="px-8 py-4"><div class="bg-white rounded-lg shadow px-6 py-3"><div class="flex items-center justify-between gap-4 flex-wrap"><div class="flex items-center gap-3"><label class="text-sm font-medium text-gray-700"> M√™s: </label><input${o("value",f.value)} type="month" class="px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"></div><div class="flex items-center gap-2 text-sm text-gray-600"><span class="font-medium">Pessoa:</span><span class="px-3 py-1 bg-primary-100 text-primary-800 rounded-full font-medium">${d(i(n))}</span></div><button${c(v.value)?" disabled":""} class="px-4 py-1.5 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400">${d(v.value?"Carregando...":"Atualizar")}</button></div></div>`),b.length>0?(t(`<div class="mt-3 px-6 py-2 bg-yellow-50 border border-yellow-200 rounded-lg"><details class="text-sm"><summary class="cursor-pointer text-yellow-800 font-medium hover:text-yellow-900"> ‚ö†Ô∏è ${d(b.length)} categoria(s) exclu√≠da(s) da an√°lise </summary><div class="mt-2 flex flex-wrap gap-2">\x3c!--[--\x3e`),u(b,e=>{t(`<span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full border border-yellow-300">${d(e)}</span>`)}),t('\x3c!--]--\x3e</div><p class="mt-2 text-xs text-yellow-700"> Para modificar, edite EXCLUDED_CATEGORIES em pages/categories.vue </p></details></div>')):t("\x3c!----\x3e"),w.length>0?(t(`<div class="mt-3 px-6 py-2 bg-blue-50 border border-blue-200 rounded-lg"><details class="text-sm"><summary class="cursor-pointer text-blue-800 font-medium hover:text-blue-900"> üíµ ${d(w.length)} categoria(s) configurada(s) como custo fixo (mesmo valor) </summary><div class="mt-2 flex flex-wrap gap-2">\x3c!--[--\x3e`),u(w,e=>{t(`<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full border border-blue-300">${d(e)}</span>`)}),t('\x3c!--]--\x3e</div><p class="mt-2 text-xs text-blue-700"> Para modificar, edite CUSTOS_FIXOS_CATEGORIES em pages/categories.vue </p></details></div>')):t("\x3c!----\x3e"),$.length>0?(t(`<div class="mt-3 px-6 py-2 bg-orange-50 border border-orange-200 rounded-lg"><details class="text-sm"><summary class="cursor-pointer text-orange-800 font-medium hover:text-orange-900"> üìå ${d($.length)} categoria(s) configurada(s) como gasto comprometido (valor vari√°vel) </summary><div class="mt-2 flex flex-wrap gap-2">\x3c!--[--\x3e`),u($,e=>{t(`<span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full border border-orange-300">${d(e)}</span>`)}),t('\x3c!--]--\x3e</div><p class="mt-2 text-xs text-orange-700"> Para modificar, edite GASTOS_COMPROMETIDOS_CATEGORIES em pages/categories.vue </p></details></div>')):t("\x3c!----\x3e"),t("</div>"),v.value?t('<div class="px-8 py-12 text-center"><div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"></div><p class="mt-4 text-gray-600">Carregando dados...</p></div>'):y.value?t(`<div class="px-8 py-12"><div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center"><p class="text-red-800 font-medium">Erro ao carregar dados</p><p class="text-red-600 text-sm mt-2">${d(y.value)}</p></div></div>`):(t(`<div class="px-8 pb-8"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6"><div class="bg-gradient-to-br from-green-500 to-green-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"><p class="text-white text-sm font-medium uppercase tracking-wide opacity-90">Gastos Vari√°veis</p><p class="text-4xl font-bold text-white mt-2">${d(formatCurrency(G.value))}</p><p class="text-green-100 text-xs mt-2">Gastos n√£o recorrentes</p></div><div class="bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"><p class="text-white text-sm font-medium uppercase tracking-wide opacity-90">Custos Fixos</p><p class="text-4xl font-bold text-white mt-2">${d(formatCurrency(I.value))}</p><p class="text-blue-100 text-xs mt-2">${d(E.value)} ${d(1===E.value?"categoria":"categorias")} ‚Ä¢ Mesmo valor</p></div><div class="bg-gradient-to-br from-orange-500 to-orange-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"><p class="text-white text-sm font-medium uppercase tracking-wide opacity-90">Gastos Comprometidos</p><p class="text-4xl font-bold text-white mt-2">${d(formatCurrency(D.value))}</p><p class="text-orange-100 text-xs mt-2">${d(A.value)} ${d(1===A.value?"categoria":"categorias")} ‚Ä¢ Valor vari√°vel</p></div><div class="bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"><p class="text-white text-sm font-medium uppercase tracking-wide opacity-90">Gasto Total</p><p class="text-4xl font-bold text-white mt-2">${d(formatCurrency(T.value))}</p><p class="text-primary-100 text-xs mt-2">Soma de todos os gastos</p></div></div><div class="bg-white rounded-lg shadow overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Categoria </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Transa√ß√µes </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Valor Total </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> % do Total </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> M√©dia por Transa√ß√£o </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),u(S.value,e=>{t(`\x3c!--[--\x3e<tr class="${p([{"bg-primary-50":h.value===e.name},"hover:bg-gray-50 transition-colors cursor-pointer"])}"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center gap-3"><svg class="${p([{"rotate-90":h.value===e.name},"h-5 w-5 text-gray-400 transition-transform"])}" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><div class="flex-shrink-0 h-12 w-12 flex items-center justify-center rounded-full bg-gradient-to-br from-primary-100 to-primary-200"><span class="text-2xl">${d((e=>{const t=e.toLowerCase();return t.includes("restaurante")||t.includes("comida")||t.includes("alimenta√ß√£o")||t.includes("almo√ßo")||t.includes("jantar")||t.includes("lanche")||t.includes("food")||t.includes("restaurant")?"üçΩÔ∏è":t.includes("mercado")||t.includes("supermercado")||t.includes("grocery")?"üõí":t.includes("uber")||t.includes("taxi")||t.includes("transporte")||t.includes("combust√≠vel")||t.includes("gasolina")||t.includes("transport")?"üöó":t.includes("sa√∫de")||t.includes("farm√°cia")||t.includes("m√©dico")||t.includes("hospital")||t.includes("health")||t.includes("pharmacy")?"‚öïÔ∏è":t.includes("educa√ß√£o")||t.includes("escola")||t.includes("curso")||t.includes("livro")||t.includes("education")?"üìö":t.includes("aluguel")||t.includes("condom√≠nio")||t.includes("casa")||t.includes("rent")||t.includes("moradia")?"üè†":t.includes("conta")||t.includes("luz")||t.includes("√°gua")||t.includes("internet")||t.includes("telefone")||t.includes("bill")?"üìÑ":t.includes("cinema")||t.includes("streaming")||t.includes("netflix")||t.includes("spotify")||t.includes("lazer")||t.includes("entertainment")?"üé¨":t.includes("roupa")||t.includes("vestu√°rio")||t.includes("loja")||t.includes("clothes")||t.includes("fashion")?"üëï":t.includes("tecnologia")||t.includes("eletr√¥nico")||t.includes("tech")||t.includes("computador")||t.includes("celular")?"üíª":t.includes("viagem")||t.includes("hotel")||t.includes("passagem")||t.includes("travel")||t.includes("flight")?"‚úàÔ∏è":t.includes("pet")||t.includes("veterin√°rio")||t.includes("animal")?"üêæ":t.includes("beleza")||t.includes("sal√£o")||t.includes("cabelo")||t.includes("beauty")||t.includes("cosm√©tico")?"üíÑ":t.includes("academia")||t.includes("esporte")||t.includes("fitness")||t.includes("gym")?"üí™":t.includes("pagamento")||t.includes("transfer√™ncia")||t.includes("pix")||t.includes("payment")||t.includes("transfer")?"üí≥":t.includes("investimento")||t.includes("poupan√ßa")||t.includes("invest")||t.includes("savings")?"üìà":t.includes("bar")||t.includes("bebida")||t.includes("caf√©")||t.includes("drink")||t.includes("coffee")?"‚òï":t.includes("presente")||t.includes("gift")?"üéÅ":t.includes("installment")||t.includes("financing")||t.includes("parcela")||t.includes("parcelamento")?"üìÖ":"üí∞"})(e.name))}</span></div><div class="ml-2"><div class="text-sm font-semibold text-gray-900">${d(e.name)}</div><div class="text-xs text-gray-500">Clique para ver transa√ß√µes</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">${d(e.count)}</span></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-lg font-bold text-primary-600">${d(formatCurrency(e.total))}</div></td><td class="px-6 py-4"><div class="flex items-center gap-3"><div class="flex-1 min-w-[120px]"><div class="w-full bg-gray-200 rounded-full h-3 shadow-inner"><div class="bg-gradient-to-r from-primary-500 to-primary-600 h-3 rounded-full transition-all duration-500 shadow" style="${m({width:`${e.percentage}%`})}"></div></div></div><span class="text-sm font-semibold text-gray-700 min-w-[45px] text-right">${d(e.percentage.toFixed(1))}%</span></div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${d(formatCurrency(e.average))}</td></tr>`),h.value===e.name?(t(`<tr class="bg-gray-50"><td colspan="5" class="px-6 py-4"><div class="space-y-2"><h4 class="text-sm font-semibold text-gray-700 mb-3"> Transa√ß√µes de ${d(e.name)} (${d(getCategoryTransactions(e.name).length)}) </h4><div class="bg-white rounded-lg shadow-inner p-4 max-h-96 overflow-y-auto"><table class="min-w-full text-sm"><thead class="bg-gray-100 sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-gray-600">Data</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-600">Origem</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-600">Descri√ß√£o</th><th class="px-3 py-2 text-right text-xs font-medium text-gray-600">Valor</th></tr></thead><tbody class="divide-y divide-gray-200">\x3c!--[--\x3e`),u(getCategoryTransactions(e.name),e=>{t(`<tr class="hover:bg-gray-50"><td class="px-3 py-2 whitespace-nowrap text-gray-900">${d((e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pt-BR")}catch{return e}})(e.date))}</td><td class="px-3 py-2 whitespace-nowrap text-gray-600">${d(e.origin)}</td><td class="px-3 py-2 text-gray-900">${d(e.description)}</td><td class="px-3 py-2 whitespace-nowrap text-right font-medium text-primary-600">${d(formatCurrency(e.amount))}</td></tr>`)}),t("\x3c!--]--\x3e</tbody></table></div></div></td></tr>")):t("\x3c!----\x3e"),t("\x3c!--]--\x3e")}),t("\x3c!--]--\x3e</tbody></table>"),0===S.value.length?t('<div class="text-center py-12"><p class="text-gray-500">Nenhuma transa√ß√£o encontrada para o per√≠odo selecionado</p></div>'):t("\x3c!----\x3e"),t("</div></div>")),t("</div>")}}}),v=g.setup;g.setup=(e,t)=>{const a=n();return(a.modules||(a.modules=new Set)).add("pages/categories.vue"),v?v(e,t):void 0};export{g as default};
