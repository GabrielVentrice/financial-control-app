import{m as X,n as J,A as m,p as l,q,B as Y,c as r,a as t,s as f,C as H,D as K,t as n,v as Q,F as g,x as h,o as i,y as B,z as W}from"#entry";import{u as Z}from"./BxOt9PVQ.js";const ee={class:"min-h-screen bg-gray-50"},te={class:"px-8 py-4"},se={class:"bg-white rounded-lg shadow px-6 py-3"},oe={class:"flex items-center justify-between gap-4 flex-wrap"},ne={class:"flex items-center gap-3"},ae={class:"flex items-center gap-2 text-sm text-gray-600"},re={class:"px-3 py-1 bg-primary-100 text-primary-800 rounded-full font-medium"},ie=["disabled"],le={key:0,class:"mt-3 px-6 py-2 bg-yellow-50 border border-yellow-200 rounded-lg"},de={class:"text-sm"},ce={class:"cursor-pointer text-yellow-800 font-medium hover:text-yellow-900"},ue={class:"mt-2 flex flex-wrap gap-2"},pe={key:1,class:"mt-3 px-6 py-2 bg-blue-50 border border-blue-200 rounded-lg"},me={class:"text-sm"},ge={class:"cursor-pointer text-blue-800 font-medium hover:text-blue-900"},xe={class:"mt-2 flex flex-wrap gap-2"},fe={key:2,class:"mt-3 px-6 py-2 bg-orange-50 border border-orange-200 rounded-lg"},he={class:"text-sm"},ye={class:"cursor-pointer text-orange-800 font-medium hover:text-orange-900"},ve={class:"mt-2 flex flex-wrap gap-2"},_e={key:0,class:"px-8 py-12 text-center"},be={key:1,class:"px-8 py-12"},we={class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},Ce={class:"text-red-600 text-sm mt-2"},Se={key:2,class:"px-8 pb-8"},ke={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6"},Te={class:"bg-gradient-to-br from-green-500 to-green-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"},Ee={class:"text-4xl font-bold text-white mt-2"},Ie={class:"bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"},De={class:"text-4xl font-bold text-white mt-2"},Me={class:"text-blue-100 text-xs mt-2"},Oe={class:"bg-gradient-to-br from-orange-500 to-orange-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"},Ae={class:"text-4xl font-bold text-white mt-2"},Ge={class:"text-orange-100 text-xs mt-2"},Fe={class:"bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow"},Re={class:"text-4xl font-bold text-white mt-2"},Be={class:"bg-white rounded-lg shadow overflow-hidden"},Le={class:"min-w-full divide-y divide-gray-200"},ze={class:"bg-white divide-y divide-gray-200"},Pe=["onClick"],Ne={class:"px-6 py-4 whitespace-nowrap"},Ue={class:"flex items-center gap-3"},Ve={class:"flex-shrink-0 h-12 w-12 flex items-center justify-center rounded-full bg-gradient-to-br from-primary-100 to-primary-200"},je={class:"text-2xl"},$e={class:"ml-2"},Xe={class:"text-sm font-semibold text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap"},qe={class:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},Ye={class:"px-6 py-4 whitespace-nowrap"},He={class:"text-lg font-bold text-primary-600"},Ke={class:"px-6 py-4"},Qe={class:"flex items-center gap-3"},We={class:"flex-1 min-w-[120px]"},Ze={class:"w-full bg-gray-200 rounded-full h-3 shadow-inner"},et={class:"text-sm font-semibold text-gray-700 min-w-[45px] text-right"},tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},st={key:0,class:"bg-gray-50"},ot={colspan:"5",class:"px-6 py-4"},nt={class:"space-y-2"},at={class:"text-sm font-semibold text-gray-700 mb-3"},rt={class:"bg-white rounded-lg shadow-inner p-4 max-h-96 overflow-y-auto"},it={class:"min-w-full text-sm"},lt={class:"divide-y divide-gray-200"},dt={class:"px-3 py-2 whitespace-nowrap text-gray-900"},ct={class:"px-3 py-2 whitespace-nowrap text-gray-600"},ut={class:"px-3 py-2 text-gray-900"},pt={class:"px-3 py-2 whitespace-nowrap text-right font-medium text-primary-600"},mt={key:0,class:"text-center py-12"},yt=X({__name:"categories",setup(gt){const{selectedPerson:y}=J(),{processInstallments:L}=Z(),z=m([]),T=m([]),x=m(!1),v=m(null),p=m(null),_=m((()=>{const s=new Date,e=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0");return`${e}-${o}`})()),b=["Sem Categoria","Credit Account Juliana","Credit Account Gabriel","Bank Account Juliana","Bank Account Gabriel","Credit Card Juliana","Credit Card Gabriel","Adjustment"],w=["Rent","Subscriptions/Softwares","Insurance","Utilities","Business & Taxes","Medical"],C=["Installments/Financing","Financing","Utilities","Business & Taxes","Investments","Medical","Rent","Subscriptions/Softwares","Insurance"],E=s=>{const e=s.toLowerCase();return b.some(o=>o.toLowerCase()===e)},S=s=>{const e=s.toLowerCase();return w.some(o=>e.includes(o.toLowerCase()))},k=s=>{const e=s.toLowerCase();return C.some(o=>e.includes(o.toLowerCase()))};l(()=>{const[s,e]=_.value.split("-");return new Date(parseInt(s),parseInt(e)-1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})});const I=l(()=>{let s=T.value;y.value!=="Ambos"&&(s=s.filter(a=>a.person===y.value));const[e,o]=_.value.split("-");return s=s.filter(a=>{const d=new Date(a.date);return d.getFullYear()===parseInt(e)&&d.getMonth()===parseInt(o)-1}),s}),D=l(()=>{const s=new Map;I.value.forEach(a=>{const d=a.destination||"Sem Categoria",R=s.get(d)||{count:0,total:0};s.set(d,{count:R.count+1,total:R.total+a.amount})});const e=M.value,o=[];return s.forEach((a,d)=>{E(d)||o.push({name:d,count:a.count,total:a.total,percentage:e>0?a.total/e*100:0,average:a.total/a.count})}),o.sort((a,d)=>d.total-a.total)}),c=l(()=>I.value.filter(s=>{const e=s.destination||"Sem Categoria";return!E(e)}));l(()=>c.value.length);const M=l(()=>c.value.reduce((s,e)=>s+e.amount,0)),P=l(()=>c.value.filter(s=>{const e=s.destination||"Sem Categoria";return S(e)}).reduce((s,e)=>s+e.amount,0)),O=l(()=>{const s=new Set;return c.value.forEach(e=>{const o=e.destination||"Sem Categoria";S(o)&&s.add(o)}),s.size}),N=l(()=>c.value.filter(s=>{const e=s.destination||"Sem Categoria";return k(e)}).reduce((s,e)=>s+e.amount,0)),A=l(()=>{const s=new Set;return c.value.forEach(e=>{const o=e.destination||"Sem Categoria";k(o)&&s.add(o)}),s.size}),U=l(()=>c.value.filter(s=>{const e=s.destination||"Sem Categoria";return!S(e)&&!k(e)}).reduce((s,e)=>s+e.amount,0)),V=s=>{const e=s.toLowerCase();return e.includes("restaurante")||e.includes("comida")||e.includes("alimenta√ß√£o")||e.includes("almo√ßo")||e.includes("jantar")||e.includes("lanche")||e.includes("food")||e.includes("restaurant")?"üçΩÔ∏è":e.includes("mercado")||e.includes("supermercado")||e.includes("grocery")?"üõí":e.includes("uber")||e.includes("taxi")||e.includes("transporte")||e.includes("combust√≠vel")||e.includes("gasolina")||e.includes("transport")?"üöó":e.includes("sa√∫de")||e.includes("farm√°cia")||e.includes("m√©dico")||e.includes("hospital")||e.includes("health")||e.includes("pharmacy")?"‚öïÔ∏è":e.includes("educa√ß√£o")||e.includes("escola")||e.includes("curso")||e.includes("livro")||e.includes("education")?"üìö":e.includes("aluguel")||e.includes("condom√≠nio")||e.includes("casa")||e.includes("rent")||e.includes("moradia")?"üè†":e.includes("conta")||e.includes("luz")||e.includes("√°gua")||e.includes("internet")||e.includes("telefone")||e.includes("bill")?"üìÑ":e.includes("cinema")||e.includes("streaming")||e.includes("netflix")||e.includes("spotify")||e.includes("lazer")||e.includes("entertainment")?"üé¨":e.includes("roupa")||e.includes("vestu√°rio")||e.includes("loja")||e.includes("clothes")||e.includes("fashion")?"üëï":e.includes("tecnologia")||e.includes("eletr√¥nico")||e.includes("tech")||e.includes("computador")||e.includes("celular")?"üíª":e.includes("viagem")||e.includes("hotel")||e.includes("passagem")||e.includes("travel")||e.includes("flight")?"‚úàÔ∏è":e.includes("pet")||e.includes("veterin√°rio")||e.includes("animal")?"üêæ":e.includes("beleza")||e.includes("sal√£o")||e.includes("cabelo")||e.includes("beauty")||e.includes("cosm√©tico")?"üíÑ":e.includes("academia")||e.includes("esporte")||e.includes("fitness")||e.includes("gym")?"üí™":e.includes("pagamento")||e.includes("transfer√™ncia")||e.includes("pix")||e.includes("payment")||e.includes("transfer")?"üí≥":e.includes("investimento")||e.includes("poupan√ßa")||e.includes("invest")||e.includes("savings")?"üìà":e.includes("bar")||e.includes("bebida")||e.includes("caf√©")||e.includes("drink")||e.includes("coffee")?"‚òï":e.includes("presente")||e.includes("gift")?"üéÅ":e.includes("installment")||e.includes("financing")||e.includes("parcela")||e.includes("parcelamento")?"üìÖ":"üí∞"},u=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),j=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("pt-BR")}catch{return s}},$=s=>{p.value===s?p.value=null:p.value=s},G=s=>c.value.filter(e=>(e.destination||"Sem Categoria")===s).sort((e,o)=>new Date(o.date).getTime()-new Date(e.date).getTime()),F=async()=>{x.value=!0,v.value=null;try{const s=await $fetch("/api/transactions");z.value=s;const e=L(s);T.value=e}catch{v.value="N√£o foi poss√≠vel carregar os dados. Tente novamente."}finally{x.value=!1}};return q(()=>{F()}),Y(y,()=>{}),(s,e)=>(i(),r("div",ee,[e[19]||(e[19]=t("div",{class:"bg-white shadow"},[t("div",{class:"px-8 py-6"},[t("h1",{class:"text-3xl font-bold text-gray-800"},"Gastos por Categoria"),t("p",{class:"text-gray-600 mt-1"},"An√°lise de despesas organizadas por categoria")])],-1)),t("div",te,[t("div",se,[t("div",oe,[t("div",ne,[e[1]||(e[1]=t("label",{class:"text-sm font-medium text-gray-700"}," M√™s: ",-1)),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),type:"month",class:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,512),[[K,_.value]])]),t("div",ae,[e[2]||(e[2]=t("span",{class:"font-medium"},"Pessoa:",-1)),t("span",re,n(Q(y)),1)]),t("button",{onClick:F,disabled:x.value,class:"px-4 py-1.5 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400"},n(x.value?"Carregando...":"Atualizar"),9,ie)])]),b.length>0?(i(),r("div",le,[t("details",de,[t("summary",ce," ‚ö†Ô∏è "+n(b.length)+" categoria(s) exclu√≠da(s) da an√°lise ",1),t("div",ue,[(i(),r(g,null,h(b,o=>t("span",{key:o,class:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full border border-yellow-300"},n(o),1)),64))]),e[3]||(e[3]=t("p",{class:"mt-2 text-xs text-yellow-700"}," Para modificar, edite EXCLUDED_CATEGORIES em pages/categories.vue ",-1))])])):f("",!0),w.length>0?(i(),r("div",pe,[t("details",me,[t("summary",ge," üíµ "+n(w.length)+" categoria(s) configurada(s) como custo fixo (mesmo valor) ",1),t("div",xe,[(i(),r(g,null,h(w,o=>t("span",{key:o,class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full border border-blue-300"},n(o),1)),64))]),e[4]||(e[4]=t("p",{class:"mt-2 text-xs text-blue-700"}," Para modificar, edite CUSTOS_FIXOS_CATEGORIES em pages/categories.vue ",-1))])])):f("",!0),C.length>0?(i(),r("div",fe,[t("details",he,[t("summary",ye," üìå "+n(C.length)+" categoria(s) configurada(s) como gasto comprometido (valor vari√°vel) ",1),t("div",ve,[(i(),r(g,null,h(C,o=>t("span",{key:o,class:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full border border-orange-300"},n(o),1)),64))]),e[5]||(e[5]=t("p",{class:"mt-2 text-xs text-orange-700"}," Para modificar, edite GASTOS_COMPROMETIDOS_CATEGORIES em pages/categories.vue ",-1))])])):f("",!0)]),x.value?(i(),r("div",_e,[...e[6]||(e[6]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Carregando dados...",-1)])])):v.value?(i(),r("div",be,[t("div",we,[e[7]||(e[7]=t("p",{class:"text-red-800 font-medium"},"Erro ao carregar dados",-1)),t("p",Ce,n(v.value),1)])])):(i(),r("div",Se,[t("div",ke,[t("div",Te,[e[8]||(e[8]=t("p",{class:"text-white text-sm font-medium uppercase tracking-wide opacity-90"},"Gastos Vari√°veis",-1)),t("p",Ee,n(u(U.value)),1),e[9]||(e[9]=t("p",{class:"text-green-100 text-xs mt-2"},"Gastos n√£o recorrentes",-1))]),t("div",Ie,[e[10]||(e[10]=t("p",{class:"text-white text-sm font-medium uppercase tracking-wide opacity-90"},"Custos Fixos",-1)),t("p",De,n(u(P.value)),1),t("p",Me,n(O.value)+" "+n(O.value===1?"categoria":"categorias")+" ‚Ä¢ Mesmo valor",1)]),t("div",Oe,[e[11]||(e[11]=t("p",{class:"text-white text-sm font-medium uppercase tracking-wide opacity-90"},"Gastos Comprometidos",-1)),t("p",Ae,n(u(N.value)),1),t("p",Ge,n(A.value)+" "+n(A.value===1?"categoria":"categorias")+" ‚Ä¢ Valor vari√°vel",1)]),t("div",Fe,[e[12]||(e[12]=t("p",{class:"text-white text-sm font-medium uppercase tracking-wide opacity-90"},"Gasto Total",-1)),t("p",Re,n(u(M.value)),1),e[13]||(e[13]=t("p",{class:"text-primary-100 text-xs mt-2"},"Soma de todos os gastos",-1))])]),t("div",Be,[t("table",Le,[e[17]||(e[17]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Categoria "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Transa√ß√µes "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Valor Total "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," % do Total "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," M√©dia por Transa√ß√£o ")])],-1)),t("tbody",ze,[(i(!0),r(g,null,h(D.value,o=>(i(),r(g,{key:o.name},[t("tr",{onClick:a=>$(o.name),class:B(["hover:bg-gray-50 transition-colors cursor-pointer",{"bg-primary-50":p.value===o.name}])},[t("td",Ne,[t("div",Ue,[(i(),r("svg",{class:B(["h-5 w-5 text-gray-400 transition-transform",{"rotate-90":p.value===o.name}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...e[14]||(e[14]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2)),t("div",Ve,[t("span",je,n(V(o.name)),1)]),t("div",$e,[t("div",Xe,n(o.name),1),e[15]||(e[15]=t("div",{class:"text-xs text-gray-500"},"Clique para ver transa√ß√µes",-1))])])]),t("td",Je,[t("span",qe,n(o.count),1)]),t("td",Ye,[t("div",He,n(u(o.total)),1)]),t("td",Ke,[t("div",Qe,[t("div",We,[t("div",Ze,[t("div",{class:"bg-gradient-to-r from-primary-500 to-primary-600 h-3 rounded-full transition-all duration-500 shadow",style:W({width:`${o.percentage}%`})},null,4)])]),t("span",et,n(o.percentage.toFixed(1))+"%",1)])]),t("td",tt,n(u(o.average)),1)],10,Pe),p.value===o.name?(i(),r("tr",st,[t("td",ot,[t("div",nt,[t("h4",at," Transa√ß√µes de "+n(o.name)+" ("+n(G(o.name).length)+") ",1),t("div",rt,[t("table",it,[e[16]||(e[16]=t("thead",{class:"bg-gray-100 sticky top-0"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-600"},"Data"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-600"},"Origem"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-600"},"Descri√ß√£o"),t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-600"},"Valor")])],-1)),t("tbody",lt,[(i(!0),r(g,null,h(G(o.name),a=>(i(),r("tr",{key:a.transactionId,class:"hover:bg-gray-50"},[t("td",dt,n(j(a.date)),1),t("td",ct,n(a.origin),1),t("td",ut,n(a.description),1),t("td",pt,n(u(a.amount)),1)]))),128))])])])])])])):f("",!0)],64))),128))])]),D.value.length===0?(i(),r("div",mt,[...e[18]||(e[18]=[t("p",{class:"text-gray-500"},"Nenhuma transa√ß√£o encontrada para o per√≠odo selecionado",-1)])])):f("",!0)])]))]))}});export{yt as default};
